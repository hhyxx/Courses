

# 1. 多值绑定

## 1.1. aspx

```html
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="ListValueBinding.aspx.cs" Inherits="WebSite9.ListValueBinding" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
     <div>
        <table style="width: 480px;">
            <tr>
                <td>
                    <asp:Panel ID="Panel1" runat="server" Height="190px" Width="160px" 
                        BorderStyle="Groove">
                        <asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="True" 
                            Height="53px" Width="150px" OnSelectedIndexChanged="DropDownList1_SelectedIndexChanged">
                            
                        </asp:DropDownList> 
                        <br />
                        <asp:Label ID="Label1" runat="server" Text="已选择" Width="92%"></asp:Label>
                        <br />
                        <asp:TextBox ID="TextBox1" runat="server" Width="150px"></asp:TextBox>
                        <br />
                    </asp:Panel>
                </td>
                <td>
                    <asp:Panel ID="Panel2" runat="server" Height="190px" Width="160px" 
                        BorderStyle="Groove" >
                        <asp:CheckBoxList ID="CheckBoxList1" runat="server" Height="98px" Width="100%">
                            <asp:ListItem>未绑定</asp:ListItem>
                        </asp:CheckBoxList>
                        <br />
                        <asp:Button ID="Button1" runat="server" Text="确  定" Width="150px" OnClick="Button1_Click" />
                        <br />
                        <asp:TextBox ID="TextBox2" runat="server" Width="150px" ></asp:TextBox>
                        <br />
                    </asp:Panel>
                </td>
                <td>
                   <asp:Panel ID="Panel3" runat="server" Height="190px" Width="200px" 
                        BorderStyle="Groove">
                        <asp:BulletedList ID="BulletedList1" runat="server" 
                            Height="160px" Target="_blank" Width="73%" BulletStyle="Disc">
                        </asp:BulletedList>
                   </asp:Panel>
                </td>
            </tr>
        </table>
    </div>
    </div>
    </form>
</body>
</html>

```



## 1.2. aspx.cs

```c#
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
namespace WebSite9{
    public partial class ListValueBinding : System.Web.UI.Page{
        //定义三种数据源
        //定义并初始化字符串数组
        String[] DDLstr = new String[] { "张小兵", "李明", "陈飞" };
        Hashtable CBLhash = new Hashtable(3);  //定义哈希表
        ArrayList BLarray = new ArrayList();    //定义ArrayList
        protected void Page_Load(object sender, EventArgs e){
            if (!IsPostBack){
                //初始化哈希表DataSourceForCBL
                this.CBLhash.Add("徐明明", "男");
                this.CBLhash.Add("韩旭", "女");
                this.CBLhash.Add("陈静", "女");

                //初始化DataSourceForBL 新建类
                this.BLarray.Add(new KeyValueClass("百度", "http://www.baidu.com"));
                this.BLarray.Add(new KeyValueClass("CSDN", "http://www.CSDN.net"));

                //为DropDownList绑定数据
                this.DropDownList1.DataSource = this.DDLstr;
                this.DropDownList1.DataBind();

                //完成绑定后在DropDownList中第一个位置插入一个数据项
                this.DropDownList1.Items.Insert(0, "请选择");

                //为CheckBoxList绑定数据
                this.CheckBoxList1.DataSource = this.DataSourceForCBL;
                //由于哈希表中存储一个键值对的集合并希望在CheckBoxList
                //中处理键值对，因此设定数据源后还需设定DataTextField和DataValueField属性
                this.CheckBoxList1.DataTextField = "key";
                this.CheckBoxList1.DataValueField = "value";
                this.CheckBoxList1.DataBind();
                
                //为BulletedList绑定数据
                this.BulletedList1.DataSource = this.BLarray;
                this.BulletedList1.DataTextField = "Name";
                this.BulletedList1.DataValueField = "Url";
                this.BulletedList1.DataBind();
            }
        }

        protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e){
            TextBox1.Text = ""; //清除上次显示内容
            //在文本框中显示所选列表项
            TextBox1.Text = DropDownList1.SelectedValue;
        }

        protected void Button1_Click(object sender, EventArgs e){
            TextBox2.Text = "";
            //循环遍历CheckBoxList中每个项，如果已选择在文本框中显示选中项显示文本和值
            foreach (ListItem li in CheckBoxList1.Items){
                if (li.Selected) TextBox2.Text += li.Text + ":" + li.Value + ",";
            }
        }
    }
}
```





# 2. GridView 的分页

+ `AllowPaging`：设置是否打开分页功能
+ `PageIndex`：当前显示的索引页
+ `PageSize`：设置每页包含的最大项数

## 2.1. aspx

```html
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="GridViewBingding_3.aspx.cs" Inherits="WebSite9.GridViewBingding_3" %>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
      <asp:GridView ID="GridView1" runat="server" AllowPaging="True" OnPageIndexChanging="GridView1_PageIndexChanging"
            PageSize="3" OnDataBound="GridView1_DataBound">
            <PagerSettings Mode="NextPrevious" NextPageText="下一页&gt;&gt;" PreviousPageText="&lt;&lt;上一页" />
        </asp:GridView>
        <asp:Label ID="Label2" runat="server" Text="Label"></asp:Label>
        &nbsp;
        <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label><br />
        <asp:Label ID="Label3" runat="server" Text="Label"></asp:Label><br />
    </div>
    </form>
</body>
</html>
```



## 2.2. aspx.cs

```c#
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Data.SqlClient;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace WebSite9
{
    public partial class GridViewBingding_3 : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            if (!Page.IsPostBack) bindgrid();
        }
        void bindgrid() // 完成数据绑定
        {
            //查询student数据库获取结果集ds
            string sqlconnstr = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString;
            DataSet ds = new DataSet();
            using (SqlConnection sqlconn = new SqlConnection(sqlconnstr))
            {
                SqlDataAdapter sqld = new SqlDataAdapter("select * from student", sqlconn);
                sqld.Fill(ds, "tabstudent");
            }
            //以数据集中名为tabstudent的DataTable作为数据源，为控件绑定数据
            GridView1.DataSource = ds.Tables["tabstudent"].DefaultView;
            GridView1.DataBind();
        }
        protected void GridView1_DataBound(object sender, EventArgs e)
        {
            //分页数据绑定前设置当前页信息
            Label2.Text = "共" + (GridView1.PageCount).ToString() + "页";
            Label1.Text = "第" + (GridView1.PageIndex + 1).ToString() + "页";
            Label3.Text = string.Format("总页数：{0}，当前页：{1}", GridView1.PageCount, GridView1.PageIndex + 1);
        }
        protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
        {
            //设置要显示的页的索引并重新绑定数据
            GridView1.PageIndex = e.NewPageIndex;
            bindgrid();
        }
    }
}
```



# 3. DataList 绑定

+ 实现数据库中的字段和显示字段的映射关系
  + `<%# Eval("XXX") %>`：其中`Eval`方法用于绑定到数据库中对应的字段

## 3.1. aspx

```html
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="DataListBingding.aspx.cs" Inherits="WebSite9.DataListBingding" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:DataList ID="DataList1" runat="server" Height="354px" RepeatColumns="5" 
            HorizontalAlign="Justify" RepeatDirection="Horizontal">
            <ItemTemplate>
                <table style="width: 154px; height: 111px">
                    <tr>
                        <td style="width: 100px">
                           <img alt="照片" src='./images/<%# Eval("Photo") %>' /></td>
                    </tr>
                    <tr>
                        <td style="width: 100px">
                            学号：<%# Eval("No") %><br />
                          	姓名：<%# Eval("Name") %><br />
                          	年龄：<%# Eval("birthday") %><br />
                          	住址：<%# Eval("Adress") %></td>
                    </tr>
                </table>
            </ItemTemplate>
        </asp:DataList>
     </div>
    </form>
</body>
</html>
```



## 3.2. aspx.cs

```c#
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Data.SqlClient;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace WebSite9
{
    public partial class DataListBingding : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            if (!Page.IsPostBack) listbind();
        }
        void listbind()
        {
            string sqlconnstr = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString; ;
            DataSet ds = new DataSet();
            using (SqlConnection sqlconn = new SqlConnection(sqlconnstr))
            {
                SqlDataAdapter sqld = new SqlDataAdapter("select * from student", sqlconn);
                sqld.Fill(ds, "tabstudent");
            }
            //以数据集中名为tabstudent的DataTable作为数据源，为控件绑定数据
            DataList1.DataSource = ds.Tables["tabstudent"].DefaultView;
            DataList1.DataBind();
        }
    }
}
```

